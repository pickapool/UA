// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace UA.Pages
{
    #line default
    using global::System;
    using global::System.Collections.Generic;
    using global::System.Linq;
    using global::System.Threading.Tasks;
    using global::Microsoft.AspNetCore.Components;
#nullable restore
#line (1,2)-(1,23) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using System.Net.Http

#nullable disable
    ;
#nullable restore
#line (2,2)-(2,28) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using System.Net.Http.Json

#nullable disable
    ;
#nullable restore
#line (3,2)-(3,45) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms

#nullable disable
    ;
#nullable restore
#line (4,2)-(4,47) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing

#nullable disable
    ;
#nullable restore
#line (5,2)-(5,43) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using Microsoft.AspNetCore.Components.Web

#nullable disable
    ;
#nullable restore
#line (6,2)-(6,58) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization

#nullable disable
    ;
#nullable restore
#line (7,2)-(7,56) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http

#nullable disable
    ;
#nullable restore
#line (8,2)-(8,27) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using Microsoft.JSInterop

#nullable disable
    ;
#nullable restore
#line (9,2)-(9,10) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA

#nullable disable
    ;
#nullable restore
#line (10,2)-(10,17) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Shared

#nullable disable
    ;
#nullable restore
#line (11,2)-(11,53) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization

#nullable disable
    ;
#nullable restore
#line (12,2)-(12,42) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using Microsoft.AspNetCore.Authorization

#nullable disable
    ;
#nullable restore
#line (13,2)-(13,49) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using System.Runtime.InteropServices.JavaScript

#nullable disable
    ;
#nullable restore
#line (15,2)-(15,29) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using Blazored.LocalStorage

#nullable disable
    ;
#nullable restore
#line (16,2)-(16,17) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using MudBlazor

#nullable disable
    ;
#nullable restore
#line (17,2)-(17,26) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using Blazored.Typeahead

#nullable disable
    ;
#nullable restore
#line (18,2)-(18,27) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using MudBlazor.Utilities

#nullable disable
    ;
#nullable restore
#line (19,2)-(19,20) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using IronBarCode;

#nullable disable
#nullable restore
#line (20,2)-(20,21) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using OfficeOpenXml

#nullable disable
    ;
#nullable restore
#line (22,2)-(22,21) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Components

#nullable disable
    ;
#nullable restore
#line (23,2)-(23,17) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Common

#nullable disable
    ;
#nullable restore
#line (24,2)-(24,16) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Enums

#nullable disable
    ;
#nullable restore
#line (25,2)-(25,17) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Models

#nullable disable
    ;
#nullable restore
#line (26,2)-(26,18) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Dialogs

#nullable disable
    ;
#nullable restore
#line (28,2)-(28,35) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Services.AccountServices

#nullable disable
    ;
#nullable restore
#line (29,2)-(29,38) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Services.DepartmentServices

#nullable disable
    ;
#nullable restore
#line (30,2)-(30,36) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Services.SanctionServices

#nullable disable
    ;
#nullable restore
#line (31,2)-(31,34) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Services.CourseServices

#nullable disable
    ;
#nullable restore
#line (32,2)-(32,35) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Services.SectionServices

#nullable disable
    ;
#nullable restore
#line (33,2)-(33,35) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Services.StudentServices

#nullable disable
    ;
#nullable restore
#line (34,2)-(34,40) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Services.UserSanctionServices

#nullable disable
    ;
#nullable restore
#line (35,2)-(35,44) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Services.DepartmentCourseServices

#nullable disable
    ;
#nullable restore
#line (36,2)-(36,34) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Services.ReportServices

#nullable disable
    ;
#nullable restore
#line (37,2)-(37,33) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Services.EventServices

#nullable disable
    ;
#nullable restore
#line (38,2)-(38,43) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Services.EventAttendanceServices

#nullable disable
    ;
#nullable restore
#line (39,2)-(39,36) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using UA.Services.ReminderServices

#nullable disable
    ;
#nullable restore
#line (41,2)-(41,43) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\_Imports.razor"
using Microsoft.AspNetCore.SignalR.Client

#nullable disable
    ;
    #line default
    #line hidden
    [global::Microsoft.AspNetCore.Components.RouteAttribute(
    // language=Route,Component
#nullable restore
#line (1,7)-(1,18) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
"/students"

#line default
#line hidden
#nullable disable
    )]
    #nullable restore
    public partial class Student : global::Microsoft.AspNetCore.Components.ComponentBase
    #nullable disable
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line (311,8)-(540,1) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"

    List<StudentModel> list = new();
    private int[] pageSize = new int[] {30, 50, 100, 500, 1000 };
    private string searchTerm = string.Empty;
    private bool IsLoading = true;
    public bool _isOpen;
    FilterParameter parameter = new();
    private DateRange _dateRange = new DateRange(DateTime.Now.Date, DateTime.Now.AddDays(5).Date);
    private IEnumerable<CourseModel> hasCourse {get; set;} = new HashSet<CourseModel>();
    private CourseModel selectedCourse = new();
    private List<CourseModel> courseList = new();
    private IEnumerable<DepartmentModel> hasDepartment {get; set;} = new HashSet<DepartmentModel>();
    private DepartmentModel selectedDepartment = new();
    private List<DepartmentModel> departmentList = new();
    private IEnumerable<SectionModel> hasSection {get; set;} = new HashSet<SectionModel>();
    private SectionModel selectedSection = new();
    private List<SectionModel> sectionList = new();
    private IEnumerable<Enums.YearLevel> hasYear {get; set;} = new HashSet<Enums.YearLevel>();
    private Enums.YearLevel selectedYear = new();
    private IEnumerable<SanctionModel> hasSanction {get; set;} = new HashSet<SanctionModel>();
    private SanctionModel selectedSanction = new();
    private List<SanctionModel> sanctionList = new();

    protected override async Task OnInitializedAsync()
    {
        GlobalClass.pageTitle = "Students";
        await GetList(new FilterParameter());
        await Courses();
        await Departments();
        await Sections();
        await Sanctions();
    }
    private async Task GetList(FilterParameter param)
    {
        IsLoading = true;
        Task<List<StudentModel>> data = StudentService.ListOfStudent(param);
        await data;
        if (data.Status == TaskStatus.RanToCompletion)
        {
            list = data.Result;
            await Task.Delay(1000);
            IsLoading = false;
            StateHasChanged();
        }
    }
    private bool FilterItems(StudentModel items)
    {
        if (string.IsNullOrEmpty(searchTerm))
            return true;
        if (items.StudentName.Contains(searchTerm, StringComparison.InvariantCultureIgnoreCase))
            return true;
        return false;
    }
    private async Task EditStudent(StudentModel dept)
    {
        var parameters = new DialogParameters();
        parameters.Add("color", dept.StudentId == 0 ? Color.Info : Color.Success);
        parameters.Add("dialogTitle", dept.StudentId == 0 ? "Add Student" : "Edit Student");
        parameters.Add("buttonText", dept.StudentId == 0 ? "Add" : "Save");
        parameters.Add("StudentModel", dept);
        MaxWidth width = MaxWidth.ExtraSmall;
        if(dept.StudentId != 0)
            width = MaxWidth.Large;
        var options = new DialogOptions() { CloseButton = false, MaxWidth = width, FullWidth = true, NoHeader = false, DisableBackdropClick = true };
        var resultDialog = await dialogService.Show<Dialogs.StudentDialog>("", parameters, options).Result;
        if (!resultDialog.Canceled)
        {
            await GetList(new FilterParameter());
        } else {
            await GetList(new FilterParameter());
        }
    }
    private async Task DeleteStudent(int id)
    {
        var parameters = new DialogParameters<Confirmation>();
        parameters.Add("ContentText", "Do you really want to delete these record? This process cannot be undone.");
        parameters.Add("ButtonText", "Yes");
        parameters.Add("Color", Color.Error);

        var options = new DialogOptions() { CloseButton = true, MaxWidth = MaxWidth.ExtraSmall };

        var dialog = await dialogService.Show<Confirmation>("Delete", parameters, options).Result;
        if(!dialog.Canceled)
        {
            IsLoading = !IsLoading;
            Task t = StudentService.DeleteStudent(id);
            await t;
            if(t.Status == TaskStatus.RanToCompletion)
            {
                await GetList(new FilterParameter());
                Extensions.ShowAlert("Student successfully remove.", Variant.Filled, Snackbar, Severity.Success);
            }
        }
    }
    public void Toggle()
    {
        if (_isOpen)
            _isOpen = false;
        else
            _isOpen = true;
    }
    public async Task Filter()
    {
        if(parameter.IsDate)
        {
            parameter.DateFrom = Convert.ToDateTime(_dateRange.Start);
            parameter.DateTo = Convert.ToDateTime(_dateRange.End);
        }
        if(parameter.IsCourse)
        {
            parameter.Courses = hasCourse.ToList();
        }
        if(parameter.IsDepartment)
        {
            parameter.Departments = hasDepartment.ToList();
        }
        if(parameter.IsSection)
        {
            parameter.Sections = hasSection.ToList();
        }
        if(parameter.IsYear)
        {
            parameter.YearLevels = hasYear.ToList();
        }
        if(parameter.IsSanction)
        {
            parameter.Sanctions = hasSanction.ToList();
        }
       await GetList(parameter);
    }
    private async Task Courses()
    {
        courseList = await courseService.ListOfCourse(new FilterParameter());
    }
    private async Task Departments()
    {
        departmentList = await departmentService.ListOfDepartment(new FilterParameter());
    }
    private async Task Sections()
    {
        sectionList = await sectionService.ListOfSection(new FilterParameter());
    }
    private string SelectedCourse(List<string> selectedCourse)
    {
        var course = "";
        foreach (var item in hasCourse)
        {
        course = string.Join(", ", hasCourse.Select(x => x.CourseName));      
        }
        return $"{course}";
    }
    private string SelectedSection(List<string> selectedSection)
    {
        var sec = "";
        foreach (var item in hasSection)
        {
        sec = string.Join(", ", hasSection.Select(x => x.SectionName));      
        }
        return $"{sec}";
    }
    private string SelectedDepartment(List<string> selectedDepartment)
    {
        var dept = "";
        foreach (var item in hasDepartment)
        {
        dept = string.Join(", ", hasDepartment.Select(x => x.DepartmentName));      
        }
        return $"{dept}";
    }
    private string SelectedYear(List<string> selectedYear)
    {
        var year = "";
        foreach (var item in hasYear)
        {
        year = string.Join(", ", hasYear.Select(x => x));      
        }
        return $"{year}";
    }
    private string SelectedSanction(List<string> selectedSanction)
    {
        var sanc = "";
        foreach (var item in hasSanction)
        {
            sanc = string.Join(", ", hasSanction.Select(x => x.SanctionName));      
        }
        return $"{sanc}";
    }
    private async Task Sanctions()
    {
        sanctionList = await sanctionService.ListOfSanction(new FilterParameter());
    }
    private async Task OpenImage(string base64)
    {
        // Generate the data URI for the base64 image
        string dataUri = $"data:image/png;base64,{base64}";

        // Open the image in a new tab
        await JSRuntime.InvokeVoidAsync("window.open", dataUri, "_blank");
    }
    private async Task GetSanctions(bool b, StudentModel student)
    {
        student.IsTableLoading = true;
        StateHasChanged();
        var param = new FilterParameter();
        param.StudentId = student.StudentId;
        if(b)
        {
            Task<List<UserSanctionModel>> list1 = UserSanctionService.ListOfUserSanction(param);
            await list1;
            if(list1.Status == TaskStatus.RanToCompletion)
            {
                list.Where( s=> s.StudentId == student.StudentId).FirstOrDefault().Sanctions = list1.Result;
                student.IsTableLoading = false;
                StateHasChanged();
            } 
        }
    }
    private async Task OpenExport()
    {
        var parameters = new DialogParameters();
        var options = new DialogOptions() { CloseButton = false, MaxWidth = MaxWidth.ExtraSmall, FullWidth = true, NoHeader = false, DisableBackdropClick = true };
        var resultDialog = await dialogService.Show<Dialogs.ExportDialog>("", parameters, options).Result;
        if (!resultDialog.Canceled)
        {
            await GetList(new FilterParameter());
        } else {
            await GetList(new FilterParameter());
        }
    }

#line default
#line hidden
#nullable disable

        [global::Microsoft.AspNetCore.Components.InjectAttribute] private 
#nullable restore
#line (11,9)-(11,19) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
IJSRuntime

#line default
#line hidden
#nullable disable
         
#nullable restore
#line (11,20)-(11,29) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
JSRuntime

#line default
#line hidden
#nullable disable
         { get; set; }
         = default!;
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private 
#nullable restore
#line (10,9)-(10,29) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
IUserSanctionService

#line default
#line hidden
#nullable disable
         
#nullable restore
#line (10,30)-(10,49) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
UserSanctionService

#line default
#line hidden
#nullable disable
         { get; set; }
         = default!;
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private 
#nullable restore
#line (9,9)-(9,25) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
ISanctionService

#line default
#line hidden
#nullable disable
         
#nullable restore
#line (9,26)-(9,41) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
sanctionService

#line default
#line hidden
#nullable disable
         { get; set; }
         = default!;
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private 
#nullable restore
#line (8,9)-(8,24) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
ISectionService

#line default
#line hidden
#nullable disable
         
#nullable restore
#line (8,25)-(8,39) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
sectionService

#line default
#line hidden
#nullable disable
         { get; set; }
         = default!;
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private 
#nullable restore
#line (7,9)-(7,27) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
IDepartmentService

#line default
#line hidden
#nullable disable
         
#nullable restore
#line (7,28)-(7,45) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
departmentService

#line default
#line hidden
#nullable disable
         { get; set; }
         = default!;
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private 
#nullable restore
#line (6,9)-(6,23) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
ICourseService

#line default
#line hidden
#nullable disable
         
#nullable restore
#line (6,24)-(6,37) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
courseService

#line default
#line hidden
#nullable disable
         { get; set; }
         = default!;
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private 
#nullable restore
#line (5,9)-(5,18) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
ISnackbar

#line default
#line hidden
#nullable disable
         
#nullable restore
#line (5,19)-(5,27) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
Snackbar

#line default
#line hidden
#nullable disable
         { get; set; }
         = default!;
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private 
#nullable restore
#line (4,9)-(4,23) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
IDialogService

#line default
#line hidden
#nullable disable
         
#nullable restore
#line (4,24)-(4,37) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
dialogService

#line default
#line hidden
#nullable disable
         { get; set; }
         = default!;
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private 
#nullable restore
#line (3,9)-(3,24) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
IStudentService

#line default
#line hidden
#nullable disable
         
#nullable restore
#line (3,25)-(3,39) "C:\Users\User\Desktop\Projects\Blazor Projects\UA\UA\Pages\Student.razor"
StudentService

#line default
#line hidden
#nullable disable
         { get; set; }
         = default!;
    }
}
#pragma warning restore 1591
